import{j as e,L as s}from"./index-VvjsA-rq.js";import{r as a}from"./chunk.BQy9AZNB.js";import{g as t}from"./chunk.DXnYxceR.js";import"./chunk.DEQ385Nk.js";import"./chunk.BhLMWRjL.js";import"./chunk.Bzdb9GAy.js";import"./web-vitals.DbSUPk88.js";const i=()=>{const{loading:i,error:n}=t(e=>e.auth),{isAuthenticated:c,serviceAccount:l}=t(e=>e.auth),[o,r]=a.useState([]),[d,h]=a.useState(null),[m,u]=a.useState(!1),[g,x]=a.useState({name:"",description:"",trigger:"schedule",action:"email",status:"active"}),[j,p]=a.useState([]),v=[{id:"auto_1",name:"BÃ¡o cÃ¡o hÃ ng ngÃ y",description:"Tá»± Ä‘á»™ng gá»­i bÃ¡o cÃ¡o hÃ ng ngÃ y lÃºc 8:00 sÃ¡ng",trigger:{type:"schedule",schedule:"0 8 * * *",timezone:"Asia/Ho_Chi_Minh"},action:{type:"email",template:"daily_report",recipients:["manager@mia.vn","admin@mia.vn"]},status:"active",lastRun:"2024-01-15T08:00:00Z",nextRun:"2024-01-16T08:00:00Z",executions:45,successRate:98.5},{id:"auto_2",name:"Backup dá»¯ liá»‡u",description:"Tá»± Ä‘á»™ng backup dá»¯ liá»‡u Google Sheets hÃ ng tuáº§n",trigger:{type:"schedule",schedule:"0 2 * * 0",timezone:"Asia/Ho_Chi_Minh"},action:{type:"backup",source:"google_sheets",destination:"google_drive"},status:"active",lastRun:"2024-01-14T02:00:00Z",nextRun:"2024-01-21T02:00:00Z",executions:8,successRate:100},{id:"auto_3",name:"ThÃ´ng bÃ¡o Ä‘Æ¡n hÃ ng má»›i",description:"Gá»­i thÃ´ng bÃ¡o Telegram khi cÃ³ Ä‘Æ¡n hÃ ng má»›i",trigger:{type:"webhook",endpoint:"/webhook/new-order",method:"POST"},action:{type:"telegram",message:"CÃ³ Ä‘Æ¡n hÃ ng má»›i: {order_id}",chatId:"-4818209867"},status:"active",lastRun:"2024-01-15T14:30:00Z",nextRun:"N/A",executions:23,successRate:95.7},{id:"auto_4",name:"Äá»“ng bá»™ inventory",description:"Äá»“ng bá»™ dá»¯ liá»‡u inventory giá»¯a cÃ¡c há»‡ thá»‘ng",trigger:{type:"schedule",schedule:"0 */6 * * *",timezone:"Asia/Ho_Chi_Minh"},action:{type:"sync",source:"google_sheets",target:"erp_system"},status:"inactive",lastRun:"2024-01-10T12:00:00Z",nextRun:"N/A",executions:156,successRate:92.3}],N=[{id:1,automationId:"auto_1",timestamp:"2024-01-15T08:00:00Z",status:"success",message:"BÃ¡o cÃ¡o hÃ ng ngÃ y Ä‘Ã£ Ä‘Æ°á»£c gá»­i thÃ nh cÃ´ng",duration:"2.3s"},{id:2,automationId:"auto_3",timestamp:"2024-01-15T14:30:00Z",status:"success",message:"ThÃ´ng bÃ¡o Ä‘Æ¡n hÃ ng #12345 Ä‘Ã£ Ä‘Æ°á»£c gá»­i",duration:"0.8s"},{id:3,automationId:"auto_2",timestamp:"2024-01-14T02:00:00Z",status:"success",message:"Backup dá»¯ liá»‡u hoÃ n thÃ nh",duration:"45.2s"},{id:4,automationId:"auto_1",timestamp:"2024-01-14T08:00:00Z",status:"error",message:"Lá»—i káº¿t ná»‘i email server",duration:"5.1s"}];a.useEffect(()=>{r(v),p(N)},[]);const b=e=>{r(s=>s.map(s=>s.id===e?{...s,status:"active"===s.status?"inactive":"active"}:s))},y=e=>new Date(e).toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),T=e=>"active"===e?"#22c55e":"#ef4444",k=e=>{switch(e){case"success":return"#22c55e";case"error":return"#ef4444";case"warning":return"#f59e0b";default:return"#3b82f6"}},f=e=>{switch(e){case"schedule":return"â°";case"webhook":return"ðŸ”—";case"manual":return"ðŸ‘†";default:return"âš¡"}},R=e=>{switch(e){case"email":return"ðŸ“§";case"telegram":return"ðŸ’¬";case"backup":return"ðŸ’¾";case"sync":return"ðŸ”„";default:return"âš¡"}};return i?e.jsx(s,{}):n?e.jsxs("div",{className:"error-state",children:["Lá»—i: ",n]}):e.jsxs("div",{className:"automation-dashboard",children:[e.jsxs("div",{className:"automation-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h1",{children:"ðŸ¤– Automation"}),e.jsx("p",{children:"Tá»± Ä‘á»™ng hÃ³a quy trÃ¬nh vÃ  cÃ´ng viá»‡c"})]}),e.jsx("div",{className:"header-right",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>u(!0),children:"âž• Táº¡o automation má»›i"})})]}),e.jsxs("div",{className:"automation-content",children:[e.jsxs("div",{className:"automations-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h3",{children:"ðŸ“‹ Danh sÃ¡ch Automation"}),e.jsxs("span",{className:"automation-count",children:[o.length," automations"]})]}),e.jsx("div",{className:"automations-list",children:o.map(s=>e.jsxs("div",{className:"automation-item "+(d?.id===s.id?"active":""),onClick:()=>(e=>{h(e)})(s),children:[e.jsxs("div",{className:"automation-info",children:[e.jsxs("div",{className:"automation-header-item",children:[e.jsx("span",{className:"automation-name",children:s.name}),e.jsx("span",{className:"automation-status",style:{color:T(s.status)},children:"active"===s.status?"ðŸŸ¢":"ðŸ”´"})]}),e.jsx("div",{className:"automation-description",children:s.description}),e.jsxs("div",{className:"automation-meta",children:[e.jsxs("span",{className:"automation-trigger",children:[f(s.trigger.type)," ",s.trigger.type]}),e.jsxs("span",{className:"automation-action",children:[R(s.action.type)," ",s.action.type]})]}),e.jsxs("div",{className:"automation-stats",children:[e.jsxs("span",{children:[s.executions," láº§n cháº¡y"]}),e.jsxs("span",{children:[s.successRate,"% thÃ nh cÃ´ng"]})]})]}),e.jsxs("div",{className:"automation-actions",children:[e.jsx("button",{className:"action-btn",onClick:e=>{e.stopPropagation(),b(s.id)},title:"active"===s.status?"Táº¡m dá»«ng":"KÃ­ch hoáº¡t",children:"active"===s.status?"â¸ï¸":"â–¶ï¸"}),e.jsx("button",{className:"action-btn",onClick:e=>{var a;e.stopPropagation(),a=s.id,r(e=>e.filter(e=>e.id!==a)),d?.id===a&&h(null)},title:"XÃ³a automation",children:"ðŸ—‘ï¸"})]})]},s.id))})]}),e.jsx("div",{className:"automation-details",children:d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"details-header",children:[e.jsxs("div",{className:"automation-title",children:[e.jsx("h3",{children:d.name}),e.jsx("span",{className:"status-badge",style:{backgroundColor:T(d.status)},children:"active"===d.status?"Hoáº¡t Ä‘á»™ng":"Táº¡m dá»«ng"})]}),e.jsx("div",{className:"details-actions",children:e.jsx("button",{className:"btn btn-secondary",onClick:()=>b(d.id),children:"active"===d.status?"â¸ï¸ Táº¡m dá»«ng":"â–¶ï¸ KÃ­ch hoáº¡t"})})]}),e.jsxs("div",{className:"details-content",children:[e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"ðŸ“ MÃ´ táº£"}),e.jsx("p",{children:d.description})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"âš¡ Trigger"}),e.jsxs("div",{className:"trigger-info",children:[e.jsxs("span",{className:"trigger-type",children:[f(d.trigger.type)," ",d.trigger.type]}),d.trigger.schedule&&e.jsxs("span",{className:"trigger-schedule",children:["Lá»‹ch: ",d.trigger.schedule]}),d.trigger.endpoint&&e.jsxs("span",{className:"trigger-endpoint",children:["Endpoint: ",d.trigger.endpoint]})]})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"ðŸŽ¯ Action"}),e.jsxs("div",{className:"action-info",children:[e.jsxs("span",{className:"action-type",children:[R(d.action.type)," ",d.action.type]}),d.action.recipients&&e.jsxs("span",{className:"action-recipients",children:["NgÆ°á»i nháº­n:"," ",d.action.recipients.join(", ")]}),d.action.chatId&&e.jsxs("span",{className:"action-chat",children:["Chat ID: ",d.action.chatId]})]})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"ðŸ“Š Thá»‘ng kÃª"}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"Láº§n cháº¡y cuá»‘i"}),e.jsx("span",{className:"stat-value",children:d.lastRun?y(d.lastRun):"ChÆ°a cháº¡y"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"Láº§n cháº¡y tiáº¿p theo"}),e.jsx("span",{className:"stat-value",children:"N/A"!==d.nextRun?y(d.nextRun):"N/A"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"Tá»•ng láº§n cháº¡y"}),e.jsx("span",{className:"stat-value",children:d.executions})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"Tá»· lá»‡ thÃ nh cÃ´ng"}),e.jsxs("span",{className:"stat-value",children:[d.successRate,"%"]})]})]})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"ðŸ“‹ Nháº­t kÃ½ thá»±c thi"}),e.jsx("div",{className:"logs-container",children:j.filter(e=>e.automationId===d.id).slice(0,10).map(s=>e.jsxs("div",{className:"log-entry",children:[e.jsx("span",{className:"log-time",children:y(s.timestamp)}),e.jsx("span",{className:"log-status",style:{color:k(s.status)},children:"success"===s.status?"âœ…":"âŒ"}),e.jsx("span",{className:"log-message",children:s.message}),e.jsx("span",{className:"log-duration",children:s.duration})]},s.id))})]})]})]}):e.jsxs("div",{className:"no-automation-selected",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ¤–"}),e.jsx("h3",{children:"Chá»n má»™t automation Ä‘á»ƒ xem chi tiáº¿t"}),e.jsx("p",{children:"Táº¡o automation má»›i hoáº·c chá»n tá»« danh sÃ¡ch bÃªn trÃ¡i"})]})})]}),m&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Táº¡o automation má»›i"}),e.jsx("button",{className:"close-btn",onClick:()=>u(!1),children:"âœ•"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"TÃªn automation"}),e.jsx("input",{type:"text",value:g.name,onChange:e=>x(s=>({...s,name:e.target.value})),placeholder:"Nháº­p tÃªn automation...",className:"input-field"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"MÃ´ táº£"}),e.jsx("textarea",{value:g.description,onChange:e=>x(s=>({...s,description:e.target.value})),placeholder:"MÃ´ táº£ chá»©c nÄƒng cá»§a automation...",className:"textarea-field",rows:"3"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Trigger"}),e.jsxs("select",{value:g.trigger,onChange:e=>x(s=>({...s,trigger:e.target.value})),className:"select-field",children:[e.jsx("option",{value:"schedule",children:"Lá»‹ch trÃ¬nh"}),e.jsx("option",{value:"webhook",children:"Webhook"}),e.jsx("option",{value:"manual",children:"Thá»§ cÃ´ng"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Action"}),e.jsxs("select",{value:g.action,onChange:e=>x(s=>({...s,action:e.target.value})),className:"select-field",children:[e.jsx("option",{value:"email",children:"Gá»­i email"}),e.jsx("option",{value:"telegram",children:"Gá»­i Telegram"}),e.jsx("option",{value:"backup",children:"Backup dá»¯ liá»‡u"}),e.jsx("option",{value:"sync",children:"Äá»“ng bá»™ dá»¯ liá»‡u"})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>u(!1),children:"Há»§y"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{if(!g.name.trim())return;const e={id:`auto_${Date.now()}`,...g,lastRun:null,nextRun:new Date(Date.now()+864e5).toISOString(),executions:0,successRate:0};r(s=>[e,...s]),x({name:"",description:"",trigger:"schedule",action:"email",status:"active"}),u(!1)},disabled:!g.name.trim(),children:"Táº¡o automation"})]})]})})]})};export{i as default};
