import{j as e,L as s}from"./index-VvjsA-rq.js";import{r as a}from"./chunk.BQy9AZNB.js";import{g as t}from"./chunk.DXnYxceR.js";import"./chunk.DEQ385Nk.js";import"./chunk.BhLMWRjL.js";import"./chunk.Bzdb9GAy.js";import"./web-vitals.DbSUPk88.js";const i=()=>{const{loading:i,error:n}=t(e=>e.auth),{isAuthenticated:c,serviceAccount:l}=t(e=>e.auth),[d,r]=a.useState(null),[h,o]=a.useState([]),[m,x]=a.useState(null),[j,u]=a.useState([]),[v,g]=a.useState(""),[N,b]=a.useState("text"),[p,_]=a.useState(!1),[y,f]=a.useState(""),[k,C]=a.useState(!1),T={id:"8434038911",username:"mia_logistics_bot",first_name:"MIA Logistics Bot",can_join_groups:!0,can_read_all_group_messages:!1,supports_inline_queries:!1},S=[{id:"-4818209867",type:"group",title:"MIA Logistics Team",username:"mia_logistics_team",member_count:15,last_activity:"2024-01-15T10:30:00Z"},{id:"123456789",type:"private",first_name:"Nguyễn Văn A",username:"nguyenvana",last_activity:"2024-01-14T15:45:00Z"},{id:"987654321",type:"private",first_name:"Trần Thị B",username:"tranthib",last_activity:"2024-01-13T09:20:00Z"}],w=[{id:1,chat_id:"-4818209867",text:"Báo cáo hàng ngày đã được tạo thành công!",date:"2024-01-15T10:30:00Z",from:"bot",message_type:"text"},{id:2,chat_id:"-4818209867",text:"Có 5 đơn hàng mới cần xử lý",date:"2024-01-15T09:15:00Z",from:"bot",message_type:"text"},{id:3,chat_id:"-4818209867",text:"Hệ thống backup đã hoàn thành",date:"2024-01-15T08:00:00Z",from:"bot",message_type:"text"}];a.useEffect(()=>{r(T),o(S),u(w),_(!0)},[]);const D=e=>new Date(e).toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),L=e=>"group"===e.type?e.title:`${e.first_name} ${e.last_name||""}`.trim(),I=e=>"group"===e.type?"👥":"👤";return i?e.jsx(s,{}):n?e.jsxs("div",{className:"error-state",children:["Lỗi: ",n]}):e.jsxs("div",{className:"telegram-container",children:[e.jsxs("div",{className:"telegram-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h1",{children:"💬 Telegram Bot"}),e.jsx("p",{children:"Quản lý và gửi thông báo qua Telegram"})]}),e.jsx("div",{className:"header-right",children:e.jsxs("div",{className:"connection-status",children:[e.jsx("div",{className:"status-dot "+(p?"connected":"disconnected")}),e.jsx("span",{children:p?"Đã kết nối":"Chưa kết nối"})]})})]}),e.jsxs("div",{className:"telegram-content",children:[e.jsxs("div",{className:"bot-info-card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{children:"🤖 Thông tin Bot"})}),e.jsx("div",{className:"card-body",children:d&&e.jsxs("div",{className:"bot-details",children:[e.jsx("div",{className:"bot-avatar",children:"🤖"}),e.jsxs("div",{className:"bot-info",children:[e.jsx("div",{className:"bot-name",children:d.first_name}),e.jsxs("div",{className:"bot-username",children:["@",d.username]}),e.jsxs("div",{className:"bot-id",children:["ID: ",d.id]})]})]})})]}),e.jsxs("div",{className:"webhook-card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{children:"🔗 Cài đặt Webhook"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"webhook-form",children:[e.jsx("input",{type:"url",placeholder:"Nhập URL webhook...",value:y,onChange:e=>f(e.target.value),className:"webhook-input"}),e.jsxs("div",{className:"webhook-actions",children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>{y.trim()&&alert("Webhook đã được thiết lập thành công!")},disabled:!y.trim(),children:"Thiết lập Webhook"}),e.jsx("button",{className:"btn btn-danger",onClick:()=>{f(""),alert("Webhook đã được xóa!")},disabled:!y.trim(),children:"Xóa Webhook"})]})]})})]}),e.jsxs("div",{className:"chats-messages-container",children:[e.jsxs("div",{className:"chats-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h3",{children:"💬 Danh sách Chat"}),e.jsxs("span",{className:"chat-count",children:[h.length," chats"]})]}),e.jsx("div",{className:"chats-list",children:h.map(s=>e.jsxs("div",{className:"chat-item "+(m?.id===s.id?"active":""),onClick:()=>(e=>{x(e);const s=j.filter(s=>s.chat_id===e.id);u(s)})(s),children:[e.jsx("div",{className:"chat-icon",children:I(s)}),e.jsxs("div",{className:"chat-info",children:[e.jsx("div",{className:"chat-name",children:L(s)}),e.jsx("div",{className:"chat-meta",children:"group"===s.type?`${s.member_count} thành viên`:"Tin nhắn riêng"}),e.jsx("div",{className:"chat-last-activity",children:D(s.last_activity)})]})]},s.id))})]}),e.jsx("div",{className:"messages-area",children:m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"messages-header",children:[e.jsxs("div",{className:"chat-title",children:[e.jsx("span",{className:"chat-icon",children:I(m)}),e.jsx("span",{children:L(m)})]}),e.jsx("div",{className:"message-actions",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>C(!0),children:"✉️ Gửi tin nhắn"})})]}),e.jsx("div",{className:"messages-list",children:j.map(s=>e.jsx("div",{className:"message-item "+("bot"===s.from?"bot-message":"user-message"),children:e.jsxs("div",{className:"message-content",children:[e.jsx("div",{className:"message-text",children:s.text}),e.jsx("div",{className:"message-time",children:D(s.date)})]})},s.id))})]}):e.jsxs("div",{className:"no-chat-selected",children:[e.jsx("div",{className:"empty-icon",children:"💬"}),e.jsx("h3",{children:"Chọn một chat để xem tin nhắn"}),e.jsx("p",{children:"Chọn từ danh sách bên trái để bắt đầu trò chuyện"})]})})]})]}),k&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Gửi tin nhắn"}),e.jsx("button",{className:"close-btn",onClick:()=>C(!1),children:"✕"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Loại tin nhắn"}),e.jsxs("select",{value:N,onChange:e=>b(e.target.value),className:"select-field",children:[e.jsx("option",{value:"text",children:"Văn bản"}),e.jsx("option",{value:"photo",children:"Hình ảnh"}),e.jsx("option",{value:"document",children:"Tài liệu"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nội dung tin nhắn"}),e.jsx("textarea",{value:v,onChange:e=>g(e.target.value),placeholder:"Nhập nội dung tin nhắn...",className:"textarea-field",rows:"4"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>C(!1),children:"Hủy"}),e.jsx("button",{className:"btn btn-primary",onClick:async()=>{if(!v.trim()||!m)return;const e={id:Date.now(),chat_id:m.id,text:v,date:(new Date).toISOString(),from:"user",message_type:N};u(s=>[e,...s]),g(""),C(!1),setTimeout(()=>{const e={id:Date.now()+1,chat_id:m.id,text:"Tin nhắn đã được gửi thành công!",date:(new Date).toISOString(),from:"bot",message_type:"text"};u(s=>[e,...s])},1e3)},disabled:!v.trim(),children:"Gửi tin nhắn"}),e.jsx("button",{className:"btn btn-warning",onClick:()=>{if(!v.trim())return;const e=h.map(e=>({id:Date.now()+Math.random(),chat_id:e.id,text:v,date:(new Date).toISOString(),from:"user",message_type:N}));u(s=>[...e,...s]),g(""),C(!1)},disabled:!v.trim(),children:"Gửi tất cả"})]})]})})]})};export{i as default};
