import{j as e,L as s}from"./index-VvjsA-rq.js";import{r as a}from"./chunk.BQy9AZNB.js";import{g as t}from"./chunk.DXnYxceR.js";import"./chunk.DEQ385Nk.js";import"./chunk.BhLMWRjL.js";import"./chunk.Bzdb9GAy.js";import"./web-vitals.DbSUPk88.js";const i=()=>{const{loading:i,error:n}=t(e=>e.auth),{isAuthenticated:c,serviceAccount:l}=t(e=>e.auth),[o,r]=a.useState([]),[d,h]=a.useState(null),[m,u]=a.useState(!1),[g,x]=a.useState({name:"",description:"",trigger:"schedule",action:"email",status:"active"}),[j,p]=a.useState([]),v=[{id:"auto_1",name:"B√°o c√°o h√†ng ng√†y",description:"T·ª± ƒë·ªông g·ª≠i b√°o c√°o h√†ng ng√†y l√∫c 8:00 s√°ng",trigger:{type:"schedule",schedule:"0 8 * * *",timezone:"Asia/Ho_Chi_Minh"},action:{type:"email",template:"daily_report",recipients:["manager@mia.vn","admin@mia.vn"]},status:"active",lastRun:"2024-01-15T08:00:00Z",nextRun:"2024-01-16T08:00:00Z",executions:45,successRate:98.5},{id:"auto_2",name:"Backup d·ªØ li·ªáu",description:"T·ª± ƒë·ªông backup d·ªØ li·ªáu Google Sheets h√†ng tu·∫ßn",trigger:{type:"schedule",schedule:"0 2 * * 0",timezone:"Asia/Ho_Chi_Minh"},action:{type:"backup",source:"google_sheets",destination:"google_drive"},status:"active",lastRun:"2024-01-14T02:00:00Z",nextRun:"2024-01-21T02:00:00Z",executions:8,successRate:100},{id:"auto_3",name:"Th√¥ng b√°o ƒë∆°n h√†ng m·ªõi",description:"G·ª≠i th√¥ng b√°o Telegram khi c√≥ ƒë∆°n h√†ng m·ªõi",trigger:{type:"webhook",endpoint:"/webhook/new-order",method:"POST"},action:{type:"telegram",message:"C√≥ ƒë∆°n h√†ng m·ªõi: {order_id}",chatId:"-4818209867"},status:"active",lastRun:"2024-01-15T14:30:00Z",nextRun:"N/A",executions:23,successRate:95.7},{id:"auto_4",name:"ƒê·ªìng b·ªô inventory",description:"ƒê·ªìng b·ªô d·ªØ li·ªáu inventory gi·ªØa c√°c h·ªá th·ªëng",trigger:{type:"schedule",schedule:"0 */6 * * *",timezone:"Asia/Ho_Chi_Minh"},action:{type:"sync",source:"google_sheets",target:"erp_system"},status:"inactive",lastRun:"2024-01-10T12:00:00Z",nextRun:"N/A",executions:156,successRate:92.3}],N=[{id:1,automationId:"auto_1",timestamp:"2024-01-15T08:00:00Z",status:"success",message:"B√°o c√°o h√†ng ng√†y ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng",duration:"2.3s"},{id:2,automationId:"auto_3",timestamp:"2024-01-15T14:30:00Z",status:"success",message:"Th√¥ng b√°o ƒë∆°n h√†ng #12345 ƒë√£ ƒë∆∞·ª£c g·ª≠i",duration:"0.8s"},{id:3,automationId:"auto_2",timestamp:"2024-01-14T02:00:00Z",status:"success",message:"Backup d·ªØ li·ªáu ho√†n th√†nh",duration:"45.2s"},{id:4,automationId:"auto_1",timestamp:"2024-01-14T08:00:00Z",status:"error",message:"L·ªói k·∫øt n·ªëi email server",duration:"5.1s"}];a.useEffect(()=>{r(v),p(N)},[]);const b=e=>{r(s=>s.map(s=>s.id===e?{...s,status:"active"===s.status?"inactive":"active"}:s))},y=e=>new Date(e).toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),T=e=>"active"===e?"#22c55e":"#ef4444",k=e=>{switch(e){case"success":return"#22c55e";case"error":return"#ef4444";case"warning":return"#f59e0b";default:return"#3b82f6"}},f=e=>{switch(e){case"schedule":return"‚è∞";case"webhook":return"üîó";case"manual":return"üëÜ";default:return"‚ö°"}},R=e=>{switch(e){case"email":return"üìß";case"telegram":return"üí¨";case"backup":return"üíæ";case"sync":return"üîÑ";default:return"‚ö°"}};return i?e.jsx(s,{}):n?e.jsxs("div",{className:"error-state",children:["L·ªói: ",n]}):e.jsxs("div",{className:"automation-dashboard",children:[e.jsxs("div",{className:"automation-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h1",{children:"ü§ñ Automation"}),e.jsx("p",{children:"T·ª± ƒë·ªông h√≥a quy tr√¨nh v√† c√¥ng vi·ªác"})]}),e.jsx("div",{className:"header-right",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>u(!0),children:"‚ûï T·∫°o automation m·ªõi"})})]}),e.jsxs("div",{className:"automation-content",children:[e.jsxs("div",{className:"automations-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h3",{children:"üìã Danh s√°ch Automation"}),e.jsxs("span",{className:"automation-count",children:[o.length," automations"]})]}),e.jsx("div",{className:"automations-list",children:o.map(s=>e.jsxs("div",{className:"automation-item "+(d?.id===s.id?"active":""),onClick:()=>(e=>{h(e)})(s),children:[e.jsxs("div",{className:"automation-info",children:[e.jsxs("div",{className:"automation-header-item",children:[e.jsx("span",{className:"automation-name",children:s.name}),e.jsx("span",{className:"automation-status",style:{color:T(s.status)},children:"active"===s.status?"üü¢":"üî¥"})]}),e.jsx("div",{className:"automation-description",children:s.description}),e.jsxs("div",{className:"automation-meta",children:[e.jsxs("span",{className:"automation-trigger",children:[f(s.trigger.type)," ",s.trigger.type]}),e.jsxs("span",{className:"automation-action",children:[R(s.action.type)," ",s.action.type]})]}),e.jsxs("div",{className:"automation-stats",children:[e.jsxs("span",{children:[s.executions," l·∫ßn ch·∫°y"]}),e.jsxs("span",{children:[s.successRate,"% th√†nh c√¥ng"]})]})]}),e.jsxs("div",{className:"automation-actions",children:[e.jsx("button",{className:"action-btn",onClick:e=>{e.stopPropagation(),b(s.id)},title:"active"===s.status?"T·∫°m d·ª´ng":"K√≠ch ho·∫°t",children:"active"===s.status?"‚è∏Ô∏è":"‚ñ∂Ô∏è"}),e.jsx("button",{className:"action-btn",onClick:e=>{var a;e.stopPropagation(),a=s.id,r(e=>e.filter(e=>e.id!==a)),d?.id===a&&h(null)},title:"X√≥a automation",children:"üóëÔ∏è"})]})]},s.id))})]}),e.jsx("div",{className:"automation-details",children:d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"details-header",children:[e.jsxs("div",{className:"automation-title",children:[e.jsx("h3",{children:d.name}),e.jsx("span",{className:"status-badge",style:{backgroundColor:T(d.status)},children:"active"===d.status?"Ho·∫°t ƒë·ªông":"T·∫°m d·ª´ng"})]}),e.jsx("div",{className:"details-actions",children:e.jsx("button",{className:"btn btn-secondary",onClick:()=>b(d.id),children:"active"===d.status?"‚è∏Ô∏è T·∫°m d·ª´ng":"‚ñ∂Ô∏è K√≠ch ho·∫°t"})})]}),e.jsxs("div",{className:"details-content",children:[e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"üìù M√¥ t·∫£"}),e.jsx("p",{children:d.description})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"‚ö° Trigger"}),e.jsxs("div",{className:"trigger-info",children:[e.jsxs("span",{className:"trigger-type",children:[f(d.trigger.type)," ",d.trigger.type]}),d.trigger.schedule&&e.jsxs("span",{className:"trigger-schedule",children:["L·ªãch: ",d.trigger.schedule]}),d.trigger.endpoint&&e.jsxs("span",{className:"trigger-endpoint",children:["Endpoint: ",d.trigger.endpoint]})]})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"üéØ Action"}),e.jsxs("div",{className:"action-info",children:[e.jsxs("span",{className:"action-type",children:[R(d.action.type)," ",d.action.type]}),d.action.recipients&&e.jsxs("span",{className:"action-recipients",children:["Ng∆∞·ªùi nh·∫≠n:"," ",d.action.recipients.join(", ")]}),d.action.chatId&&e.jsxs("span",{className:"action-chat",children:["Chat ID: ",d.action.chatId]})]})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"üìä Th·ªëng k√™"}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"L·∫ßn ch·∫°y cu·ªëi"}),e.jsx("span",{className:"stat-value",children:d.lastRun?y(d.lastRun):"Ch∆∞a ch·∫°y"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"L·∫ßn ch·∫°y ti·∫øp theo"}),e.jsx("span",{className:"stat-value",children:"N/A"!==d.nextRun?y(d.nextRun):"N/A"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"T·ªïng l·∫ßn ch·∫°y"}),e.jsx("span",{className:"stat-value",children:d.executions})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"T·ª∑ l·ªá th√†nh c√¥ng"}),e.jsxs("span",{className:"stat-value",children:[d.successRate,"%"]})]})]})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"üìã Nh·∫≠t k√Ω th·ª±c thi"}),e.jsx("div",{className:"logs-container",children:j.filter(e=>e.automationId===d.id).slice(0,10).map(s=>e.jsxs("div",{className:"log-entry",children:[e.jsx("span",{className:"log-time",children:y(s.timestamp)}),e.jsx("span",{className:"log-status",style:{color:k(s.status)},children:"success"===s.status?"‚úÖ":"‚ùå"}),e.jsx("span",{className:"log-message",children:s.message}),e.jsx("span",{className:"log-duration",children:s.duration})]},s.id))})]})]})]}):e.jsxs("div",{className:"no-automation-selected",children:[e.jsx("div",{className:"empty-icon",children:"ü§ñ"}),e.jsx("h3",{children:"Ch·ªçn m·ªôt automation ƒë·ªÉ xem chi ti·∫øt"}),e.jsx("p",{children:"T·∫°o automation m·ªõi ho·∫∑c ch·ªçn t·ª´ danh s√°ch b√™n tr√°i"})]})})]}),m&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"T·∫°o automation m·ªõi"}),e.jsx("button",{className:"close-btn",onClick:()=>u(!1),children:"‚úï"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"T√™n automation"}),e.jsx("input",{type:"text",value:g.name,onChange:e=>x(s=>({...s,name:e.target.value})),placeholder:"Nh·∫≠p t√™n automation...",className:"input-field"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"M√¥ t·∫£"}),e.jsx("textarea",{value:g.description,onChange:e=>x(s=>({...s,description:e.target.value})),placeholder:"M√¥ t·∫£ ch·ª©c nƒÉng c·ªßa automation...",className:"textarea-field",rows:"3"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Trigger"}),e.jsxs("select",{value:g.trigger,onChange:e=>x(s=>({...s,trigger:e.target.value})),className:"select-field",children:[e.jsx("option",{value:"schedule",children:"L·ªãch tr√¨nh"}),e.jsx("option",{value:"webhook",children:"Webhook"}),e.jsx("option",{value:"manual",children:"Th·ªß c√¥ng"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Action"}),e.jsxs("select",{value:g.action,onChange:e=>x(s=>({...s,action:e.target.value})),className:"select-field",children:[e.jsx("option",{value:"email",children:"G·ª≠i email"}),e.jsx("option",{value:"telegram",children:"G·ª≠i Telegram"}),e.jsx("option",{value:"backup",children:"Backup d·ªØ li·ªáu"}),e.jsx("option",{value:"sync",children:"ƒê·ªìng b·ªô d·ªØ li·ªáu"})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>u(!1),children:"H·ªßy"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{if(!g.name.trim())return;const e={id:`auto_${Date.now()}`,...g,lastRun:null,nextRun:new Date(Date.now()+864e5).toISOString(),executions:0,successRate:0};r(s=>[e,...s]),x({name:"",description:"",trigger:"schedule",action:"email",status:"active"}),u(!1)},disabled:!g.name.trim(),children:"T·∫°o automation"})]})]})})]})};export{i as default};
