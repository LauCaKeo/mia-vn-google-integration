import{j as e,L as i}from"./index-VvjsA-rq.js";import{r as s}from"./chunk.BQy9AZNB.js";import{g as n}from"./chunk.DXnYxceR.js";import"./chunk.DEQ385Nk.js";import"./chunk.BhLMWRjL.js";import"./chunk.Bzdb9GAy.js";import"./web-vitals.DbSUPk88.js";const t=()=>{const{loading:t,error:a}=n(e=>e.drive),{isAuthenticated:d,serviceAccount:l}=n(e=>e.auth),[c,o]=s.useState(null),[m,r]=s.useState([]),[h,v]=s.useState([]),[p,u]=s.useState([]),[x,j]=s.useState("grid"),[g,b]=s.useState(""),[f,N]=s.useState(!1),[w,B]=s.useState(""),[k,T]=s.useState(""),y=[{id:"1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms",name:"BÃ¡o cÃ¡o thÃ¡ng 1.xlsx",type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",size:"2.5 MB",modifiedTime:"2024-01-15T10:30:00Z",owner:"admin@mia.vn",webViewLink:"https://drive.google.com/file/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/view"},{id:"1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms2",name:"Danh sÃ¡ch khÃ¡ch hÃ ng.pdf",type:"application/pdf",size:"1.2 MB",modifiedTime:"2024-01-14T15:45:00Z",owner:"admin@mia.vn",webViewLink:"https://drive.google.com/file/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms2/view"},{id:"1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms3",name:"Há»£p Ä‘á»“ng máº«u.docx",type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",size:"850 KB",modifiedTime:"2024-01-13T09:20:00Z",owner:"admin@mia.vn",webViewLink:"https://drive.google.com/file/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms3/view"}],C=[{id:"1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms_folder1",name:"TÃ i liá»‡u cÃ´ng ty",modifiedTime:"2024-01-15T10:30:00Z",owner:"admin@mia.vn"},{id:"1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms_folder2",name:"BÃ¡o cÃ¡o hÃ ng thÃ¡ng",modifiedTime:"2024-01-14T15:45:00Z",owner:"admin@mia.vn"},{id:"1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms_folder3",name:"Há»£p Ä‘á»“ng khÃ¡ch hÃ ng",modifiedTime:"2024-01-13T09:20:00Z",owner:"admin@mia.vn"}];s.useEffect(()=>{r(y),v(C)},[]);const M=m.filter(e=>e.name.toLowerCase().includes(g.toLowerCase())),U=h.filter(e=>e.name.toLowerCase().includes(g.toLowerCase())),V=e=>{u(i=>i.includes(e)?i.filter(i=>i!==e):[...i,e])},L=e=>new Date(e).toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return t?e.jsx(i,{}):a?e.jsxs("div",{className:"error-state",children:["Lá»—i: ",a]}):e.jsxs("div",{className:"drive-integration-container",children:[e.jsxs("div",{className:"drive-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h1",{children:"ðŸ“ Google Drive"}),e.jsxs("div",{className:"breadcrumb",children:[e.jsx("span",{children:"Drive cá»§a tÃ´i"}),c&&e.jsxs("span",{children:[" / ",c.name]})]})]}),e.jsxs("div",{className:"header-right",children:[e.jsxs("div",{className:"view-controls",children:[e.jsx("button",{className:"view-btn "+("grid"===x?"active":""),onClick:()=>j("grid"),children:"âŠž"}),e.jsx("button",{className:"view-btn "+("list"===x?"active":""),onClick:()=>j("list"),children:"â˜°"})]}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>{B("folder"),N(!0)},children:"ðŸ“ Táº¡o thÆ° má»¥c"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{B("file"),N(!0)},children:"ðŸ“„ Táº¡o tá»‡p"}),e.jsx("button",{className:"btn btn-secondary",children:"â¬†ï¸ Táº£i lÃªn"})]})]})]}),e.jsxs("div",{className:"drive-toolbar",children:[e.jsx("div",{className:"toolbar-left",children:e.jsx("input",{type:"text",placeholder:"TÃ¬m kiáº¿m tá»‡p tin vÃ  thÆ° má»¥c...",value:g,onChange:e=>b(e.target.value),className:"search-input"})}),e.jsxs("div",{className:"toolbar-right",children:[p.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"selected-count",children:[p.length," má»¥c Ä‘Ã£ chá»n"]}),e.jsx("button",{className:"btn btn-danger",onClick:()=>{0!==p.length&&(r(e=>e.filter(e=>!p.includes(e.id))),v(e=>e.filter(e=>!p.includes(e.id))),u([]))},children:"ðŸ—‘ï¸ XÃ³a"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>{0!==p.length&&p.forEach(e=>{const i=[...m,...h].find(i=>i.id===e);i&&i.webViewLink&&window.open(i.webViewLink,"_blank")})},children:"â¬‡ï¸ Táº£i xuá»‘ng"})]}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>{const e=[["TÃªn","Loáº¡i","KÃ­ch thÆ°á»›c","NgÃ y sá»­a","Chá»§ sá»Ÿ há»¯u","ID"],...m.map(e=>[e.name,e.type,e.size,new Date(e.modifiedTime).toLocaleDateString("vi-VN"),e.owner,e.id])].map(e=>e.join(",")).join("\n"),i=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(i),s.download="google_drive_files.csv",s.click()},children:"ðŸ“Š Xuáº¥t CSV"})]})]}),e.jsxs("div",{className:"drive-content",children:[U.length>0&&e.jsxs("div",{className:"folders-section",children:[e.jsx("h3",{children:"ðŸ“ ThÆ° má»¥c"}),e.jsx("div",{className:`items-grid ${x}`,children:U.map(i=>e.jsxs("div",{className:"item-card "+(p.includes(i.id)?"selected":""),onClick:()=>V(i.id),children:[e.jsx("div",{className:"item-icon",children:"ðŸ“"}),e.jsxs("div",{className:"item-info",children:[e.jsx("div",{className:"item-name",children:i.name}),e.jsx("div",{className:"item-meta",children:L(i.modifiedTime)})]}),e.jsx("div",{className:"item-actions",children:e.jsx("button",{className:"action-btn",onClick:e=>{e.stopPropagation()},title:"Xem ID",children:"ðŸ‘ï¸"})})]},i.id))})]}),M.length>0&&e.jsxs("div",{className:"files-section",children:[e.jsx("h3",{children:"ðŸ“„ Tá»‡p tin"}),e.jsx("div",{className:`items-grid ${x}`,children:M.map(i=>{return e.jsxs("div",{className:"item-card "+(p.includes(i.id)?"selected":""),onClick:()=>V(i.id),children:[e.jsx("div",{className:"item-icon",children:(n=i.type,n.includes("spreadsheet")?"ðŸ“Š":n.includes("document")?"ðŸ“„":n.includes("pdf")?"ðŸ“•":n.includes("image")?"ðŸ–¼ï¸":n.includes("video")?"ðŸŽ¥":n.includes("audio")?"ðŸŽµ":n.includes("folder")?"ðŸ“":"ðŸ“„")}),e.jsxs("div",{className:"item-info",children:[e.jsx("div",{className:"item-name",children:i.name}),e.jsxs("div",{className:"item-meta",children:[(s=i.size,s||"0 KB")," â€¢"," ",L(i.modifiedTime)]})]}),e.jsxs("div",{className:"item-actions",children:[e.jsx("button",{className:"action-btn",onClick:e=>{e.stopPropagation(),window.open(i.webViewLink,"_blank")},title:"Má»Ÿ",children:"ðŸ”—"}),e.jsx("button",{className:"action-btn",onClick:e=>{e.stopPropagation()},title:"Xem ID",children:"ðŸ‘ï¸"})]})]},i.id);var s,n})})]}),0===M.length&&0===U.length&&e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“"}),e.jsx("h3",{children:"KhÃ´ng cÃ³ tá»‡p tin nÃ o"}),e.jsx("p",{children:"Táº¡o thÆ° má»¥c hoáº·c táº£i lÃªn tá»‡p tin Ä‘á»ƒ báº¯t Ä‘áº§u"})]})]}),f&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"file"===w?"Táº¡o tá»‡p tin má»›i":"Táº¡o thÆ° má»¥c má»›i"}),e.jsx("button",{className:"close-btn",onClick:()=>N(!1),children:"âœ•"})]}),e.jsx("div",{className:"modal-body",children:e.jsx("input",{type:"text",placeholder:"file"===w?"TÃªn tá»‡p tin":"TÃªn thÆ° má»¥c",value:k,onChange:e=>T(e.target.value),className:"input-field",autoFocus:!0})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>N(!1),children:"Há»§y"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{if(!k.trim())return;const e={id:`new_${Date.now()}`,name:k,type:"file"===w?"text/plain":"application/vnd.google-apps.folder",size:"file"===w?"0 KB":"",modifiedTime:(new Date).toISOString(),owner:"admin@mia.vn"};"file"===w?r(i=>[e,...i]):v(i=>[e,...i]),T(""),N(!1),B("")},disabled:!k.trim(),children:"Táº¡o"})]})]})})]})};export{t as default};
