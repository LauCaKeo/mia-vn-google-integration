import{j as e,L as s}from"./index-VvjsA-rq.js";import{r as t}from"./chunk.BQy9AZNB.js";import{g as a}from"./chunk.DXnYxceR.js";import"./chunk.DEQ385Nk.js";import"./chunk.BhLMWRjL.js";import"./chunk.Bzdb9GAy.js";import"./web-vitals.DbSUPk88.js";const n=()=>{const{loading:n,error:i}=a(e=>e.auth),{isAuthenticated:c,serviceAccount:r}=a(e=>e.auth),[l,o]=t.useState([]),[d,h]=t.useState(null),[p,m]=t.useState(""),[g,u]=t.useState(!1),[x,j]=t.useState([]),[v,N]=t.useState(!1),[S,b]=t.useState(""),[f,y]=t.useState(""),D=[{id:"script_1",name:"T·ª± ƒë·ªông g·ª≠i email b√°o c√°o",description:"G·ª≠i email b√°o c√°o h√†ng ng√†y cho qu·∫£n l√Ω",lastModified:"2024-01-15T10:30:00Z",status:"active",executions:45,code:"function sendDailyReport() {\n  const sheet = SpreadsheetApp.getActiveSheet();\n  const data = sheet.getDataRange().getValues();\n\n  // T·∫°o b√°o c√°o\n  let report = \"B√°o c√°o h√†ng ng√†y:\\n\\n\";\n  report += \"T·ªïng s·ªë ƒë∆°n h√†ng: \" + data.length + \"\\n\";\n  report += \"Ng√†y: \" + new Date().toLocaleDateString('vi-VN');\n\n  // G·ª≠i email\n  MailApp.sendEmail({\n    to: 'manager@mia.vn',\n    subject: 'B√°o c√°o h√†ng ng√†y - ' + new Date().toLocaleDateString('vi-VN'),\n    body: report\n  });\n\n  console.log('Email ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng');\n}"},{id:"script_2",name:"ƒê·ªìng b·ªô d·ªØ li·ªáu Google Sheets",description:"ƒê·ªìng b·ªô d·ªØ li·ªáu gi·ªØa c√°c sheet kh√°c nhau",lastModified:"2024-01-14T15:45:00Z",status:"active",executions:23,code:"function syncSheetsData() {\n  const sourceSheet = SpreadsheetApp.openById('SOURCE_SHEET_ID').getActiveSheet();\n  const targetSheet = SpreadsheetApp.openById('TARGET_SHEET_ID').getActiveSheet();\n\n  const data = sourceSheet.getDataRange().getValues();\n  targetSheet.getRange(1, 1, data.length, data[0].length).setValues(data);\n\n  console.log('D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c ƒë·ªìng b·ªô th√†nh c√¥ng');\n}"},{id:"script_3",name:"T·ª± ƒë·ªông backup d·ªØ li·ªáu",description:"T·∫°o backup d·ªØ li·ªáu h√†ng tu·∫ßn",lastModified:"2024-01-13T09:20:00Z",status:"inactive",executions:8,code:"function weeklyBackup() {\n  const sheet = SpreadsheetApp.getActiveSheet();\n  const data = sheet.getDataRange().getValues();\n\n  // T·∫°o file backup\n  const backupSheet = SpreadsheetApp.create('Backup_' + new Date().getTime());\n  backupSheet.getActiveSheet().getRange(1, 1, data.length, data[0].length).setValues(data);\n\n  console.log('Backup ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng');\n}"}];t.useEffect(()=>{o(D)},[]);const k=e=>{switch(e){case"success":return"#22c55e";case"error":return"#ef4444";case"warning":return"#f59e0b";default:return"#3b82f6"}};return n?e.jsx(s,{}):i?e.jsxs("div",{className:"error-state",children:["L·ªói: ",i]}):e.jsxs("div",{className:"apps-script-container",children:[e.jsxs("div",{className:"script-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h1",{children:"‚öôÔ∏è Google Apps Script"}),e.jsx("p",{children:"T·ª± ƒë·ªông h√≥a c√¥ng vi·ªác v·ªõi Google Apps Script"})]}),e.jsx("div",{className:"header-right",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>N(!0),children:"‚ûï T·∫°o script m·ªõi"})})]}),e.jsxs("div",{className:"script-content",children:[e.jsxs("div",{className:"scripts-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h3",{children:"üìú Danh s√°ch Scripts"}),e.jsxs("span",{className:"script-count",children:[l.length," scripts"]})]}),e.jsx("div",{className:"scripts-list",children:l.map(s=>{return e.jsxs("div",{className:"script-item "+(d?.id===s.id?"active":""),onClick:()=>(e=>{h(e),m(e.code)})(s),children:[e.jsxs("div",{className:"script-info",children:[e.jsx("div",{className:"script-name",children:s.name}),e.jsx("div",{className:"script-description",children:s.description}),e.jsxs("div",{className:"script-meta",children:[e.jsx("span",{className:"script-status",style:{color:(t=s.status,"active"===t?"#22c55e":"#ef4444")},children:"active"===s.status?"üü¢ Ho·∫°t ƒë·ªông":"üî¥ T·∫°m d·ª´ng"}),e.jsxs("span",{className:"script-executions",children:[s.executions," l·∫ßn ch·∫°y"]})]})]}),e.jsx("div",{className:"script-actions",children:e.jsx("button",{className:"action-btn",onClick:e=>{var t;e.stopPropagation(),t=s.id,o(e=>e.filter(e=>e.id!==t)),d?.id===t&&(h(null),m(""))},title:"X√≥a script",children:"üóëÔ∏è"})})]},s.id);var t})})]}),e.jsx("div",{className:"script-editor",children:d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"editor-header",children:[e.jsxs("div",{className:"script-title",children:[e.jsx("h3",{children:d.name}),e.jsxs("span",{className:"script-id",children:["ID: ",d.id]})]}),e.jsxs("div",{className:"editor-actions",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>{d&&(o(e=>e.map(e=>e.id===d.id?{...e,code:p,lastModified:(new Date).toISOString()}:e)),h(e=>({...e,code:p,lastModified:(new Date).toISOString()})))},children:"üíæ L∆∞u"}),e.jsx("button",{className:"btn btn-primary",onClick:async()=>{if(!d)return;u(!0),j([]);const e=[{time:(new Date).toISOString(),message:"B·∫Øt ƒë·∫ßu th·ª±c thi script...",type:"info"},{time:(new Date).toISOString(),message:"K·∫øt n·ªëi Google Sheets...",type:"info"},{time:(new Date).toISOString(),message:"ƒê·ªçc d·ªØ li·ªáu...",type:"info"},{time:(new Date).toISOString(),message:"X·ª≠ l√Ω d·ªØ li·ªáu...",type:"info"},{time:(new Date).toISOString(),message:"Ho√†n th√†nh th√†nh c√¥ng!",type:"success"}];for(let s=0;s<e.length;s++)await new Promise(e=>setTimeout(e,1e3)),j(t=>[...t,e[s]]);u(!1)},disabled:g,children:g?"‚è≥ ƒêang ch·∫°y...":"‚ñ∂Ô∏è Ch·∫°y script"})]})]}),e.jsx("div",{className:"code-editor",children:e.jsx("textarea",{value:p,onChange:e=>m(e.target.value),placeholder:"Vi·∫øt code JavaScript c·ªßa b·∫°n ·ªü ƒë√¢y...",className:"code-textarea"})}),x.length>0&&e.jsxs("div",{className:"execution-logs",children:[e.jsx("h4",{children:"üìã Nh·∫≠t k√Ω th·ª±c thi"}),e.jsx("div",{className:"logs-container",children:x.map((s,t)=>e.jsxs("div",{className:"log-entry",children:[e.jsx("span",{className:"log-time",children:new Date(s.time).toLocaleTimeString("vi-VN")}),e.jsx("span",{className:"log-message",style:{color:k(s.type)},children:s.message})]},t))})]})]}):e.jsxs("div",{className:"no-script-selected",children:[e.jsx("div",{className:"empty-icon",children:"‚öôÔ∏è"}),e.jsx("h3",{children:"Ch·ªçn m·ªôt script ƒë·ªÉ ch·ªânh s·ª≠a"}),e.jsx("p",{children:"T·∫°o script m·ªõi ho·∫∑c ch·ªçn t·ª´ danh s√°ch b√™n tr√°i"})]})})]}),v&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"T·∫°o script m·ªõi"}),e.jsx("button",{className:"close-btn",onClick:()=>N(!1),children:"‚úï"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"T√™n script"}),e.jsx("input",{type:"text",value:S,onChange:e=>b(e.target.value),placeholder:"Nh·∫≠p t√™n script...",className:"input-field"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"M√¥ t·∫£"}),e.jsx("textarea",{value:f,onChange:e=>y(e.target.value),placeholder:"M√¥ t·∫£ ch·ª©c nƒÉng c·ªßa script...",className:"textarea-field",rows:"3"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>N(!1),children:"H·ªßy"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{if(!S.trim())return;const e={id:`script_${Date.now()}`,name:S,description:f,lastModified:(new Date).toISOString(),status:"active",executions:0,code:`function ${S.replace(/\s+/g,"")}() {\n  // Vi·∫øt code c·ªßa b·∫°n ·ªü ƒë√¢y\n  console.log('Script m·ªõi ƒë√£ ƒë∆∞·ª£c t·∫°o');\n}`};o(s=>[e,...s]),b(""),y(""),N(!1)},disabled:!S.trim(),children:"T·∫°o script"})]})]})})]})};export{n as default};
