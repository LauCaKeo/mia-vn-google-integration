import{j as e,L as s}from"./index-VvjsA-rq.js";import{r as t}from"./chunk.BQy9AZNB.js";import{g as n}from"./chunk.DXnYxceR.js";import"./chunk.DEQ385Nk.js";import"./chunk.BhLMWRjL.js";import"./chunk.Bzdb9GAy.js";import"./web-vitals.DbSUPk88.js";const a=()=>{const{loading:a,error:c}=n(e=>e.sheets),{isAuthenticated:i,serviceAccount:l}=n(e=>e.auth),[o,r]=t.useState(null),[d,h]=t.useState([]),[m,u]=t.useState(!1),[j,x]=t.useState({}),[b,p]=t.useState(""),[N,v]=t.useState([]),[C,g]=t.useState(!1),[y,k]=t.useState(""),[f,S]=t.useState(!1),[w,D]=t.useState(""),[L,P]=t.useState([]),O=[{id:"18B1PIhCDmBWyHZytvOcfj_1QbYBwczLf1x1Qbu0E5As",title:"mia-logistics-final",sheets:[{name:"Orders",id:0,rowCount:150,columnCount:8},{name:"Inventory",id:1,rowCount:75,columnCount:6},{name:"Customers",id:2,rowCount:200,columnCount:5},{name:"Suppliers",id:3,rowCount:50,columnCount:7},{name:"Analytics",id:4,rowCount:30,columnCount:4}]}],T={Orders:[["ID","Customer","Product","Quantity","Price","Date","Status","Notes"],["ORD001","Nguyễn Văn A","Laptop Dell","1","15000000","2024-01-15","Completed","Delivered on time"],["ORD002","Trần Thị B","Mouse Logitech","2","500000","2024-01-16","Processing","Waiting for stock"],["ORD003","Lê Văn C","Keyboard Mechanical","1","1200000","2024-01-17","Pending","Customer review"],["ORD004","Phạm Thị D",'Monitor 24"',"1","3500000","2024-01-18","Completed","Express delivery"],["ORD005","Hoàng Văn E","Webcam HD","1","800000","2024-01-19","Processing","Standard shipping"]],Inventory:[["Product ID","Product Name","Stock","Min Stock","Price","Category"],["PROD001","Laptop Dell","25","5","15000000","Electronics"],["PROD002","Mouse Logitech","150","20","500000","Accessories"],["PROD003","Keyboard Mechanical","45","10","1200000","Accessories"],["PROD004",'Monitor 24"',"12","3","3500000","Electronics"],["PROD005","Webcam HD","30","8","800000","Accessories"]]};t.useEffect(()=>{o&&h(T[o.name]||[])},[o,T]),t.useEffect(()=>{if(b){const e=d.filter(e=>e.some(e=>e.toString().toLowerCase().includes(b.toLowerCase())));v(e)}else v(d)},[b,d]);const R=()=>{const e=N.map(e=>e.join(",")).join("\n"),s=new Blob([e],{type:"text/csv"}),t=window.URL.createObjectURL(s),n=document.createElement("a");n.href=t,n.download=`${o?.name||"sheet"}.csv`,n.click(),window.URL.revokeObjectURL(t)};return a?e.jsx(s,{text:"Đang tải Google Sheets...",fullScreen:!0}):c?e.jsxs("div",{className:"sheets-error",children:[e.jsx("h3",{children:"Lỗi kết nối Google Sheets"}),e.jsx("p",{children:c}),e.jsx("button",{onClick:()=>window.location.reload(),children:"Thử lại"})]}):e.jsxs("div",{className:"google-sheets-integration",children:[e.jsxs("div",{className:"sheets-header",children:[e.jsx("h2",{children:"📊 Google Sheets Integration"}),e.jsx("div",{className:"sheets-controls",children:o&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"edit-btn",onClick:()=>u(!m),children:m?"💾 Lưu":"✏️ Chỉnh sửa"}),e.jsx("button",{className:"export-btn",onClick:R,children:"📥 Xuất CSV"})]})})]}),e.jsxs("div",{className:"sheets-container",children:[e.jsxs("div",{className:"sheets-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h3",{children:"📋 Danh sách Sheets"}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>g(!0),children:"➕ Tạo sheet mới"})]}),e.jsx("div",{className:"sheet-list",children:O.map(s=>e.jsxs("div",{className:"spreadsheet-group",children:[e.jsx("div",{className:"spreadsheet-title",children:s.title}),s.sheets.map(s=>e.jsxs("div",{className:"sheet-item "+(o?.id===s.id?"active":""),onClick:()=>(e=>{r(e),u(!1),x({})})(s),children:[e.jsxs("div",{className:"sheet-info",children:[e.jsx("span",{className:"sheet-name",children:s.name}),e.jsxs("span",{className:"sheet-meta",children:[s.rowCount," hàng × ",s.columnCount," cột"]})]}),e.jsx("div",{className:"sheet-actions",children:e.jsx("button",{className:"action-btn",onClick:e=>{e.stopPropagation(),alert(`ID: ${s.id||o?.id}`)},title:"Xem ID",children:"👁️"})})]},s.id))]},s.id))}),o&&e.jsxs("div",{className:"sheet-actions-panel",children:[e.jsx("h4",{children:"Thao tác với Sheet"}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>u(!m),children:m?"💾 Lưu":"✏️ Chỉnh sửa"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>S(!0),children:"➕ Thêm cột"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>{if(!o)return;const e=Array(o.headers.length).fill("");h([...d,e])},children:"➕ Thêm hàng"}),e.jsx("button",{className:"btn btn-warning btn-sm",onClick:()=>{const e=d.filter(e=>e.some(e=>""!==e.toString().trim()));h(e)},children:"🗑️ Xóa hàng trống"}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:R,children:"📊 Xuất CSV"})]})]})]}),e.jsx("div",{className:"sheets-content",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"sheet-header",children:[e.jsx("h3",{children:o.name}),e.jsxs("div",{className:"sheet-actions",children:[e.jsx("input",{type:"text",placeholder:"🔍 Tìm kiếm...",value:b,onChange:e=>p(e.target.value),className:"search-input"}),e.jsxs("span",{className:"row-count",children:[N.length," rows"]})]})]}),e.jsx("div",{className:"sheet-table-container",children:e.jsxs("table",{className:"sheet-table",children:[e.jsx("thead",{children:N.length>0&&e.jsx("tr",{children:N[0].map((s,t)=>e.jsx("th",{children:s},t))})}),e.jsx("tbody",{children:N.slice(1).map((s,t)=>e.jsx("tr",{children:s.map((s,n)=>e.jsx("td",{children:m?e.jsx("input",{type:"text",value:j[`${t+1}-${n}`]||s,onChange:e=>((e,s,t)=>{x({...j,[`${e}-${s}`]:t})})(t+1,n,e.target.value),className:"cell-input"}):e.jsx("span",{className:"cell-content",children:s})},n))},t))})]})})]}):e.jsxs("div",{className:"no-sheet-selected",children:[e.jsx("div",{className:"no-sheet-icon",children:"📊"}),e.jsx("h3",{children:"Chọn một sheet để xem dữ liệu"}),e.jsx("p",{children:"Nhấp vào một sheet trong danh sách bên trái để bắt đầu"})]})})]}),C&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Tạo sheet mới"}),e.jsx("button",{className:"close-btn",onClick:()=>g(!1),children:"✕"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tên sheet"}),e.jsx("input",{type:"text",value:y,onChange:e=>k(e.target.value),placeholder:"Nhập tên sheet...",className:"input-field"})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>g(!1),children:"Hủy"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{if(!y.trim())return;const e={name:y,id:Date.now(),rowCount:1,columnCount:5};O[0].sheets.push(e),k(""),g(!1)},disabled:!y.trim(),children:"Tạo sheet"})]})]})}),f&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Thêm cột mới"}),e.jsx("button",{className:"close-btn",onClick:()=>S(!1),children:"✕"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tên cột"}),e.jsx("input",{type:"text",value:w,onChange:e=>D(e.target.value),placeholder:"Nhập tên cột...",className:"input-field"})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>S(!1),children:"Hủy"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{if(!w.trim()||!o)return;const e=d.map((e,s)=>0===s?[...e,w]:[...e,""]);h(e),D(""),S(!1)},disabled:!w.trim(),children:"Thêm cột"})]})]})})]})};export{a as default};
